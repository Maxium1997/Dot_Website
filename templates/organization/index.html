{% extends 'base.html' %}
{% load static %}

{% block subtitle %}Organization{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item active" aria-current="page">Organization</li>
{% endblock %}

{% block body %}
<div class="container mt-4">
    <div class="d-flex gap-2 mb-4">
        <a href="{% url 'download_unit_template' %}" class="btn btn-outline-success">
            <i class="fas fa-file-download"></i> 下載範本
        </a>
        <a href="{% url 'upload_units' %}" class="btn btn-outline-primary">
            <i class="fas fa-file-upload"></i> 上傳匯入
        </a>
    </div>

    <div class="org-tree-container">
        <ul class="root-tree">
            {% for unit in root_units %}
                {% include "organization/unit_node.html" with unit=unit %}
            {% empty %}
                <p class="text-muted">目前暫無組織資料，請先下載範本並匯入。</p>
            {% endfor %}
        </ul>
    </div>
</div>

<style>
    /* 樹狀圖連接線邏輯 */
    .org-tree-container ul {
        list-style: none;
        padding-left: 20px;
        border-left: 1px solid #dee2e6; /* 垂直主線 */
        margin-top: 10px;
    }

    .org-unit-item {
        position: relative;
        margin-bottom: 10px;
        padding-left: 20px;
    }

    /* 水平連接線 */
    .org-unit-item::before {
        content: "";
        position: absolute;
        top: 15px;
        left: 0;
        width: 15px;
        height: 1px;
        background-color: #dee2e6;
    }

    /* 單位卡片樣式 */
    .unit-card {
        display: inline-flex;
        align-items: center;
        padding: 8px 15px;
        background: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        transition: transform 0.2s;
    }

    .unit-card:hover {
        transform: translateX(5px);
        border-color: #0d6efd;
        cursor: pointer;
    }

    .unit-name {
        font-weight: 600;
        color: #212529;
    }

    .unit-info {
        font-size: 0.8rem;
        color: #6c757d;
        margin-left: 10px;
        padding-left: 10px;
        border-left: 1px solid #eee;
    }

    /* 隱藏最外層的垂直線 */
    ul.root-tree {
        border-left: none;
        padding-left: 0;
    }
</style>
{% endblock %}